<!DOCTYPE html>
<html>
<head>
  <title>RoastTiers ðŸ˜ˆðŸ”¥</title>
  <style>
    body { font-family: Arial, sans-serif; background: #111; color: #fff; text-align: center; padding: 50px; }
    h1 { color: orange; }
    .tier { margin: 20px auto; padding: 10px; border: 2px solid #ff6600; border-radius: 8px; background: #222; max-width: 400px; }
    .tier-list { list-style: none; padding: 0; margin: 10px 0 0 0; color: lime; }
    #adminForm, #logoutBtn, #profileBtn, #accountPage, #changePassForm { display: none; }
    #loginForm, #signupForm { margin-bottom: 30px; }
    input, select, button { padding: 8px; margin: 5px; border-radius: 4px; border: none; }
    .pfp { width: 80px; height: 80px; border-radius: 50%; margin-bottom: 10px; object-fit: cover; }
    .link-list { list-style: none; padding: 0; }
  </style>
</head>
<body>
  <h1>ðŸ”¥ RoastTiers ðŸ˜ˆ</h1>
  <p>The official ladder for the best (and worst) roasters.</p>

  <!-- Login form -->
  <form id="loginForm">
    <input type="text" id="loginUser" placeholder="Username" required>
    <input type="password" id="loginPass" placeholder="Password" required>
    <button type="submit">Login</button>
    <p>or <a href="#" onclick="showSignup()">Sign Up</a></p>
  </form>

  <!-- Signup form -->
  <form id="signupForm">
    <input type="text" id="signupUser" placeholder="Username" required>
    <input type="password" id="signupPass" placeholder="Password" required>
    <input type="text" id="signupBio" placeholder="Bio">
    <input type="text" id="signupLinks" placeholder="Links (comma-separated)">
    <input type="text" id="signupPfp" placeholder="Profile Pic URL (optional)">
    <label><input type="checkbox" id="signupAdmin"> Admin</label>
    <button type="submit">Sign Up</button>
    <p>Already have an account? <a href="#" onclick="showLogin()">Log In</a></p>
  </form>

  <!-- Admin form -->
  <form id="adminForm">
    <input type="text" id="username" placeholder="Name to add" required>
    <select id="tier">
      <option value="HT1">HT1 â€“ Roast Gods</option>
      <option value="HT2">HT2 â€“ Elite Roasters</option>
      <option value="HT3">HT3 â€“ Consistent Burners</option>
      <option value="HT4">HT4 â€“ Crowd-Pleasers</option>
      <option value="HT5">HT5 â€“ Average Roasters</option>
      <option value="LT1">LT1 â€“ Decent but shaky</option>
      <option value="LT2">LT2 â€“ Weak sauce</option>
      <option value="LT3">LT3 â€“ Kinda funny sometimes</option>
      <option value="LT4">LT4 â€“ Struggle Burns</option>
      <option value="LT5">LT5 â€“ Bottom of the barrel</option>
    </select>
    <button type="submit">Add Name</button>
  </form>
  <button id="logoutBtn">Logout</button>
  <button id="profileBtn">My Account</button>

  <!-- Account/Profile Page -->
  <div id="accountPage">
    <img id="accountPfp" class="pfp" src="" alt="Profile Pic">
    <h2 id="accountName"></h2>
    <p id="accountBio"></p>
    <ul id="accountLinks" class="link-list"></ul>
    <button onclick="showChangePass()">Change Password</button>
    <button onclick="hideAccount()">Back</button>
  </div>

  <!-- Change Password Form -->
  <form id="changePassForm">
    <input type="password" id="oldPass" placeholder="Old password" required>
    <input type="password" id="newPass" placeholder="New password" required>
    <button type="submit">Change Password</button>
    <button type="button" onclick="hideChangePass()">Cancel</button>
  </form>

  <!-- Tier lists -->
  <div class="tier" id="HT1"><b>HT1</b> â€“ Roast Gods<ul class="tier-list"></ul></div>
  <div class="tier" id="HT2"><b>HT2</b> â€“ Elite Roasters<ul class="tier-list"></ul></div>
  <div class="tier" id="HT3"><b>HT3</b> â€“ Consistent Burners<ul class="tier-list"></ul></div>
  <div class="tier" id="HT4"><b>HT4</b> â€“ Crowd-Pleasers<ul class="tier-list"></ul></div>
  <div class="tier" id="HT5"><b>HT5</b> â€“ Average Roasters<ul class="tier-list"></ul></div>
  <div class="tier" id="LT1"><b>LT1</b> â€“ Decent but shaky<ul class="tier-list"></ul></div>
  <div class="tier" id="LT2"><b>LT2</b> â€“ Weak sauce<ul class="tier-list"></ul></div>
  <div class="tier" id="LT3"><b>LT3</b> â€“ Kinda funny sometimes<ul class="tier-list"></ul></div>
  <div class="tier" id="LT4"><b>LT4</b> â€“ Struggle Burns<ul class="tier-list"></ul></div>
  <div class="tier" id="LT5"><b>LT5</b> â€“ Bottom of the barrel<ul class="tier-list"></ul></div>
  <script>
    // ========== Account System ==========
    function getUsers() {
      return JSON.parse(localStorage.getItem("users") || "[]");
    }
    function saveUsers(users) {
      localStorage.setItem("users", JSON.stringify(users));
    }
    function getLoggedInUser() {
      return localStorage.getItem("currentUser") || "";
    }
    function setLoggedInUser(username) {
      localStorage.setItem("currentUser", username);
    }
    function hash(s) {
      // Simple fake hash for demo purposes
      return btoa(s);
    }

    // ========== UI Toggle ==========
    function showLogin() {
      document.getElementById("loginForm").style.display = "block";
      document.getElementById("signupForm").style.display = "none";
      document.getElementById("adminForm").style.display = "none";
      document.getElementById("logoutBtn").style.display = "none";
      document.getElementById("profileBtn").style.display = "none";
      document.getElementById("accountPage").style.display = "none";
      document.getElementById("changePassForm").style.display = "none";
    }
    function showSignup() {
      document.getElementById("loginForm").style.display = "none";
      document.getElementById("signupForm").style.display = "block";
      document.getElementById("adminForm").style.display = "none";
      document.getElementById("logoutBtn").style.display = "none";
      document.getElementById("profileBtn").style.display = "none";
      document.getElementById("accountPage").style.display = "none";
      document.getElementById("changePassForm").style.display = "none";
    }
    function showAccount() {
      var user = getUsers().find(u => u.username === getLoggedInUser());
      if(!user) return;
      document.getElementById("accountPfp").src = user.pfp || "https://avatars.githubusercontent.com/u/583231?v=4";
      document.getElementById("accountName").textContent = user.username;
      document.getElementById("accountBio").textContent = user.bio;
      var links = user.links ? user.links : [];
      const ul = document.getElementById("accountLinks");
      ul.innerHTML = "";
      links.forEach(link => {
        const li = document.createElement("li");
        li.innerHTML = `<a href="${link}" target="_blank">${link}</a>`;
        ul.appendChild(li);
      });
      document.getElementById("accountPage").style.display = "block";
      document.getElementById("adminForm").style.display = "none";
      document.getElementById("loginForm").style.display = "none";
      document.getElementById("signupForm").style.display = "none";
      document.getElementById("changePassForm").style.display = "none";
      document.getElementById("profileBtn").style.display = "none";
      document.getElementById("logoutBtn").style.display = "block";
    }
    function hideAccount() {
      checkLogin();
    }
    function showChangePass() {
      document.getElementById("accountPage").style.display = "none";
      document.getElementById("changePassForm").style.display = "block";
    }
    function hideChangePass() {
      document.getElementById("changePassForm").style.display = "none";
      showAccount();
    }

    // ========== Login / Signup ==========
    document.getElementById("loginForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const user = document.getElementById("loginUser").value;
      const pass = hash(document.getElementById("loginPass").value);
      const users = getUsers();
      const found = users.find(u => u.username === user && u.password === pass);
      if(found) {
        setLoggedInUser(user);
        checkLogin();
      } else {
        alert("Incorrect login!");
      }
    });

    document.getElementById("signupForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const username = document.getElementById("signupUser").value.trim();
      const password = hash(document.getElementById("signupPass").value);
      const bio = document.getElementById("signupBio").value.trim();
      const links = document.getElementById("signupLinks").value.trim().split(",").map(l=>l.trim()).filter(l=>l);
      const pfp = document.getElementById("signupPfp").value.trim();
      const isAdmin = document.getElementById("signupAdmin").checked;
      if(!username || !password) return alert("Username and password required!");
      const users = getUsers();
      if(users.find(u => u.username === username)) return alert("Username already exists!");
      users.push({username, password, isAdmin, bio, links, pfp});
      saveUsers(users);
      setLoggedInUser(username);
      checkLogin();
    });

    document.getElementById("changePassForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const oldPass = hash(document.getElementById("oldPass").value);
      const newPass = hash(document.getElementById("newPass").value);
      const users = getUsers();
      const user = getLoggedInUser();
      const idx = users.findIndex(u => u.username === user);
      if(idx === -1) return alert("User not found!");
      if(users[idx].password !== oldPass) return alert("Old password incorrect!");
      users[idx].password = newPass;
      saveUsers(users);
      alert("Password changed!");
      hideChangePass();
    });

    // ========== Logout/Profile ==========
    document.getElementById("logoutBtn").addEventListener("click", function() {
      localStorage.removeItem("currentUser");
      checkLogin();
    });
    document.getElementById("profileBtn").addEventListener("click", function() {
      showAccount();
    });

    // ========== Admin Tier Adding ==========
    const tiers = {
      HT1: [],
      HT2: [],
      HT3: [],
      HT4: [],
      HT5: [],
      LT1: [],
      LT2: [],
      LT3: [],
      LT4: [],
      LT5: []
    };

    document.getElementById("adminForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const name = document.getElementById("username").value.trim();
      const tier = document.getElementById("tier").value;
      if(name) {
        tiers[tier].push(name);
        updateTierDisplay(tier);
        document.getElementById("username").value = "";
      }
    });

    function updateTierDisplay(tier) {
      const ul = document.querySelector(`#${tier} .tier-list`);
      ul.innerHTML = "";
      tiers[tier].forEach(person => {
        const li = document.createElement("li");
        li.textContent = person;
        ul.appendChild(li);
      });
    }

    // ========== Login State Check ==========
    function checkLogin() {
      const user = getUsers().find(u => u.username === getLoggedInUser());
      if(user) {
        document.getElementById("logoutBtn").style.display = "inline-block";
        document.getElementById("profileBtn").style.display = "inline-block";
        if(user.isAdmin) {
          document.getElementById("adminForm").style.display = "block";
        } else {
          document.getElementById("adminForm").style.display = "none";
        }
        document.getElementById("loginForm").style.display = "none";
        document.getElementById("signupForm").style.display = "none";
        document.getElementById("accountPage").style.display = "none";
        document.getElementById("changePassForm").style.display = "none";
      } else {
        showLogin();
      }
    }

    // Initial state
    checkLogin();
  </script>
</body>
</html>
